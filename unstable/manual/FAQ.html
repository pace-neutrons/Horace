<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FAQ &mdash; Horace  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Unsorted Manual Pages" href="../Unsorted.html" />
    <link rel="prev" title="Input file formats" href="Input_file_formats.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Horace
            <img src="../_static/150px-Quintus_Horatius_Flaccus.jpg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Introduction.html">Introduction and Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../User_guide.html">User’s Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../Horace_manual.html">Horace Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Changing_Horace_settings.html">Changing Horace settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="Planning_a_Horace_scan.html">Planning a Horace scan</a></li>
<li class="toctree-l2"><a class="reference internal" href="Generating_SQW_files.html">Generating SQW files</a></li>
<li class="toctree-l2"><a class="reference internal" href="Manipulating_and_extracting_data_from_SQW_files_and_objects.html">Manipulating and extracting data from SQW files and objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="Correcting_for_sample_misalignment.html">Correcting for sample misalignment</a></li>
<li class="toctree-l2"><a class="reference internal" href="Data_diagnostics.html">Data diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="Symmetrising_etc.html">Symmetrising etc</a></li>
<li class="toctree-l2"><a class="reference internal" href="Unary_operations.html">Unary operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="Binary_operations.html">Binary operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="Plotting.html">Plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="Simulation.html">Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Multifit.html">Multifit</a></li>
<li class="toctree-l2"><a class="reference internal" href="Advanced_Multifit.html">Advanced Multifit</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tobyfit.html">Tobyfit</a></li>
<li class="toctree-l2"><a class="reference internal" href="Parallel.html">Running Horace in Parallel</a></li>
<li class="toctree-l2"><a class="reference internal" href="List_of_functions.html">List of functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Input_file_formats.html">Input file formats</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">FAQ</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#can-i-include-more-than-one-data-file-spe-nxspe-with-the-same-experimental-configuration-in-an-sqw-file">Can I include more than one data file (spe/nxspe) with the same experimental configuration in an sqw file?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-difference-between-sqw-and-dnd-objects">The difference between sqw and dnd objects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#memory-requirements">Memory requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#implications-for-simulations-and-fitting">Implications for simulations and fitting</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#i-ve-got-a-problem-and-i-can-t-find-figure-out-how-to-solve-it-from-the-information-on-this-website">I’ve got a problem and I can’t find figure out how to solve it from the information on this website!</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Unsorted.html">Unsorted Manual Pages</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Citing.html">Citing Horace</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Developers.html">For Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Contributing.html">Contributing to Horace</a></li>
<li class="toctree-l1"><a class="reference internal" href="../API_Reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../General_disclaimer.html">General disclaimer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Privacy_policy.html">Privacy Policy</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Horace</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../Horace_manual.html">Horace Manual</a></li>
      <li class="breadcrumb-item active">FAQ</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/manual/FAQ.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="faq">
<h1>FAQ<a class="headerlink" href="#faq" title="Permalink to this heading"></a></h1>
<p>Some frequently asked questions about Horace</p>
<section id="can-i-include-more-than-one-data-file-spe-nxspe-with-the-same-experimental-configuration-in-an-sqw-file">
<h2>Can I include more than one data file (spe/nxspe) with the same experimental configuration in an sqw file?<a class="headerlink" href="#can-i-include-more-than-one-data-file-spe-nxspe-with-the-same-experimental-configuration-in-an-sqw-file" title="Permalink to this heading"></a></h2>
<p>Yes! The <code class="docutils literal notranslate"><span class="pre">gen_sqw</span></code> routine will check for repeat entries of filenames, so that you cannot accidentally include the same run twice. But you can have the same experimental conditions (Ei and psi) for different runs and include them. For example, suppose you had the same values of psi and Ei for file1 and fileN-1, and file2 and fileN, in the example below:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">my_files</span><span class="p">={</span><span class="s">&#39;file1&#39;</span><span class="p">,</span><span class="s">&#39;file2&#39;</span><span class="p">,</span><span class="s">&#39;file3&#39;</span><span class="p">,</span><span class="k">...</span><span class="c">,&#39;fileN-1&#39;,&#39;fileN};</span><span class="w"></span>
<span class="k">...</span><span class="w"></span>
<span class="nb">psi</span><span class="p">=[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="k">...</span><span class="c">.,1,2]</span><span class="w"></span>
<span class="k">...</span><span class="w"></span>

<span class="n">gen_sqw</span><span class="p">(</span><span class="k">...</span><span class="c">,my_files,...psi,...)</span><span class="w"></span>
</pre></div>
</div>
<p>In the resultant sqw file the data from file1 and fileN-1, and file2 and fileN, will be combined and normalised correctly.</p>
</section>
<section id="the-difference-between-sqw-and-dnd-objects">
<h2>The difference between sqw and dnd objects<a class="headerlink" href="#the-difference-between-sqw-and-dnd-objects" title="Permalink to this heading"></a></h2>
<p>The technical differences between dnd and sqw objects are dealt with in <a class="reference internal" href="../user_guide/Advanced_use.html#creating-an-object-from-scratch"><span class="std std-ref">Advanced use</span></a>. Both data objects contain the same arrays of signals, variances, plot and integration axis coordinates etc., but the sqw object contains an additional array which provides detailed information about every detector-energy pixel from every run which contributed to the signal in the object. It also contains more information about the original contributing NXSPE files and in particular allows for instrument information to be stored that enables resolution convolution to be performed.</p>
<section id="memory-requirements">
<h3>Memory requirements<a class="headerlink" href="#memory-requirements" title="Permalink to this heading"></a></h3>
<p>Equivalent sqw and dnd objects require vastly different amounts of computer memory. The dnd object is usually relatively small (typical 0.1-10MB), whereas an sqw object can easily be &gt;1GB. This is because in the sqw object, nine numbers (see <a class="reference internal" href="../user_guide/Advanced_use.html#creating-an-object-from-scratch"><span class="std std-ref">Advanced use</span></a> for details) are retained about each detector-energy pixel element that contributed to the observed signal. In a normal Horace experiment this often equates to many millions of detector elements, hence the large memory requirement to store all this information. SQW files that are created from experiments can exceed 1TB if read into memory: don’t try to do that unless you are very sure about the size of the file and the memory on your computer!</p>
</section>
<section id="implications-for-simulations-and-fitting">
<h3>Implications for simulations and fitting<a class="headerlink" href="#implications-for-simulations-and-fitting" title="Permalink to this heading"></a></h3>
<p>The difference between sqw and dnd objects is clearly manifest, and potentially most significant, when simulating and/or fitting a S(Q,w) model to the data.</p>
<p>Consider the case of a 2-dimensional slice by way of an example, where the plot axes are (h,0,0) and (0,k,0), and we integrate energy between 10meV and 20meV and integrate (0,0,l) between -0.5 and 0.5. Suppose this material is 3-dimensional, so that there are excitations that disperse along all 3 of the Q directions. We simulate a model S(Q,w) which includes this 3-dimensional dispersion, but find that the simulations look totally different if we simulate equivalent dnd and sqw data objects. What is going on?</p>
<p>For the sqw object, the S(Q,w) model is calculated at the (h,k,l,e) co-ordinates of every single contributing detector pixel (of which there are potentially many millions), and then combined in the same way that the data are to produce a 2-dimensional colour map. Because we integrated over quite a wide range of (0,0,l) and energy, detector elements with similar (h,k) co-ordinates of can have totally different (0,0,l) and energy co-ordinates, and hence totally different S(Q,w). When we sum these elements together we get something that should (assuming the model is good) look very similar to the data.</p>
<p>For the dnd object, we do not have the the (0,0,l) and energy co-ordinates of the contributing detector elements any more. So for each (h,k) bin we only have the average value of (0,0,l) and energy - in this case l=0 and e=15meV respectively. The S(Q,w) model is thus only evaluated at these single points in (0,0,l) and energy, and the full dispersion is thus not captured, and the simulated intensity is likely to be wrong.</p>
<p>A caveat to this is the case where the S(Q,w) model does not give a 3-dimensional dispersion, e.g. S(Q,w) is independent of (0,0,l). In this case the dnd and sqw object simulations will be the same.</p>
</section>
</section>
<section id="i-ve-got-a-problem-and-i-can-t-find-figure-out-how-to-solve-it-from-the-information-on-this-website">
<h2>I’ve got a problem and I can’t find figure out how to solve it from the information on this website!<a class="headerlink" href="#i-ve-got-a-problem-and-i-can-t-find-figure-out-how-to-solve-it-from-the-information-on-this-website" title="Permalink to this heading"></a></h2>
<p>First, double check that the information really isn’t hidden away on the website somewhere by using the <strong>search</strong> tool located on the left-hand side of all the pages on this website. In the case that you have found the function that you need but it is crashing even though you have checked that you are using it correctly, make sure you have the latest version of Horace installed.</p>
<p>If that fails, or the information on the site doesn’t answer your question, email us at <a class="reference external" href="mailto:HoraceHelp&#37;&#52;&#48;stfc&#46;ac&#46;uk">Horace Help</a>. We will be happy to help you.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Input_file_formats.html" class="btn btn-neutral float-left" title="Input file formats" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../Unsorted.html" class="btn btn-neutral float-right" title="Unsorted Manual Pages" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2006-2022, STFC RAL.
      <span class="lastupdated">Last updated on Nov 25, 2022, 10:27:28 AM.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
<br><br>
<a href="https://github.com/pace-neutrons/Horace/edit/master/documentation/user_docs/docs/manual/FAQ.rst">Click here to edit</a> or <a href="https://github.com/pace-neutrons/Horace/edit/master/documentation/user_docs/docs/new_page.rst">Click here to add new page</a> (requires <a href="https://github.com/login">GitHub account</a>).
<br>
For more info on editing <a href="../Contributing.html">click here</a>.


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>