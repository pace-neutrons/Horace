<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FAQ &mdash; Horace  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=b3ba4146"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Unsorted Manual Pages" href="../Unsorted.html" />
    <link rel="prev" title="Input file formats" href="Input_file_formats.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Horace
              <img src="../_static/150px-Quintus_Horatius_Flaccus.jpg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Introduction.html">Introduction and Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../User_guide.html">User’s Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../Horace_manual.html">Horace Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Planning_a_Horace_scan.html">Planning a Horace scan</a></li>
<li class="toctree-l2"><a class="reference internal" href="Generating_SQW_files.html">Generating SQW files</a></li>
<li class="toctree-l2"><a class="reference internal" href="Data_diagnostics.html">Data diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="Correcting_for_sample_misalignment.html">Correcting for sample misalignment</a></li>
<li class="toctree-l2"><a class="reference internal" href="Manipulating_and_extracting_data_from_SQW_files_and_objects.html">Manipulating and extracting data from SQW files and objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="Reshaping_etc.html">Other shape functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Symmetrising_etc.html">Symmetry Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="Unary_operations.html">Unary operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="Binary_operations.html">Binary operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="Plotting.html">Plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="Simulation.html">Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Multifit.html">Multifit</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tobyfit.html">Tobyfit</a></li>
<li class="toctree-l2"><a class="reference internal" href="Parallel.html">Running Horace in Parallel</a></li>
<li class="toctree-l2"><a class="reference internal" href="Changing_Horace_settings.html">Changing Horace settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="Changing_Horace_settings.html">Changing Horace settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="List_of_functions.html">List of functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Input_file_formats.html">Input file formats</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">FAQ</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#can-i-include-more-than-one-data-file-spe-nxspe-with-the-same-experimental-configuration-in-an-sqw-file">Can I include more than one data file (spe/nxspe) with the same experimental configuration in an sqw file?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#what-is-the-difference-between-sqw-and-dnd-objects">What is the difference between sqw and dnd objects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="#memory-requirements">Memory requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#implications-for-simulations-and-fitting">Implications for simulations and fitting</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#i-ve-got-a-problem-and-i-can-t-find-figure-out-how-to-solve-it-from-the-information-on-this-website">I’ve got a problem and I can’t find figure out how to solve it from the information on this website!</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Unsorted.html">Unsorted Manual Pages</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Example_scripts.html">Example Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Citing.html">Citing Horace</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Developers.html">For Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Contributing.html">Contributing to Horace</a></li>
<li class="toctree-l1"><a class="reference internal" href="../API_Reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../General_disclaimer.html">General disclaimer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Previous_versions.html">Previous Versions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Horace</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../Horace_manual.html">Horace Manual</a></li>
      <li class="breadcrumb-item active">FAQ</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/manual/FAQ.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="faq">
<h1>FAQ<a class="headerlink" href="#faq" title="Permalink to this heading"></a></h1>
<p>Some frequently asked questions about Horace</p>
<section id="can-i-include-more-than-one-data-file-spe-nxspe-with-the-same-experimental-configuration-in-an-sqw-file">
<h2>Can I include more than one data file (spe/nxspe) with the same experimental configuration in an sqw file?<a class="headerlink" href="#can-i-include-more-than-one-data-file-spe-nxspe-with-the-same-experimental-configuration-in-an-sqw-file" title="Permalink to this heading"></a></h2>
<p>Yes! The <code class="docutils literal notranslate"><span class="pre">gen_sqw</span></code> routine will check for repeat entries of filenames, so that
you cannot accidentally include the same run twice. But you can have the same
experimental conditions (<span class="math notranslate nohighlight">\(E_i\)</span> and <span class="math notranslate nohighlight">\(\psi\)</span>) for different runs and
include them. For example, suppose you had the same values of <span class="math notranslate nohighlight">\(\psi\)</span> and
<span class="math notranslate nohighlight">\(E_i\)</span> for <code class="docutils literal notranslate"><span class="pre">file1</span></code> and <code class="docutils literal notranslate"><span class="pre">fileN-1</span></code>, and <code class="docutils literal notranslate"><span class="pre">file2</span></code> and <code class="docutils literal notranslate"><span class="pre">fileN</span></code>, in the
example below:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span>my_files={&#39;file1&#39;,&#39;file2&#39;,&#39;file3&#39;,..,&#39;fileN-1&#39;,&#39;fileN};
...
psi=[1,2,3,..,1,2]
...

gen_sqw(..,my_files,..psi,..)
</pre></div>
</div>
<p>In the resulting <code class="docutils literal notranslate"><span class="pre">.sqw</span></code> file the data from <code class="docutils literal notranslate"><span class="pre">file1</span></code> and <code class="docutils literal notranslate"><span class="pre">fileN-1</span></code>, and
<code class="docutils literal notranslate"><span class="pre">file2</span></code> and <code class="docutils literal notranslate"><span class="pre">fileN</span></code>, will be combined and normalised correctly.</p>
</section>
<section id="what-is-the-difference-between-sqw-and-dnd-objects">
<h2>What is the difference between sqw and dnd objects<a class="headerlink" href="#what-is-the-difference-between-sqw-and-dnd-objects" title="Permalink to this heading"></a></h2>
<section id="summary">
<h3>Summary<a class="headerlink" href="#summary" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">sqw</span></code> object carries around an array containing the information of each
detector-energy pixel which underlies the result in a raw form. These pixels are
then accumulated and binned into the intensity histogram which makes up the
<code class="docutils literal notranslate"><span class="pre">dnd</span></code>. <code class="docutils literal notranslate"><span class="pre">sqw</span></code> s also carry around details about the contributing <code class="docutils literal notranslate"><span class="pre">.nxspe</span></code>
files from which it was made and, in particular, allows for instrunment
information to be attached enabling resolution-convolution to be performed.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All <code class="docutils literal notranslate"><span class="pre">sqw</span></code> objects have a <code class="docutils literal notranslate"><span class="pre">dnd</span></code> in their <code class="docutils literal notranslate"><span class="pre">data</span></code> property.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">dnd</span></code> should be thought of as the resulting image from the accumulation of
pixels in an <code class="docutils literal notranslate"><span class="pre">sqw</span></code> object. It carries around a projection (which orients the
display [plotting] region in reciprocal space) and a set of axes which define a
plotting region and the histogram bins into which the pixels are accumulated.</p>
<p>Should a <code class="docutils literal notranslate"><span class="pre">dnd</span></code> be separated from an <code class="docutils literal notranslate"><span class="pre">sqw</span></code> (e.g. by using the <code class="docutils literal notranslate"><span class="pre">-nopix</span></code>
option on a <a class="reference internal" href="Manipulating_and_extracting_data_from_SQW_files_and_objects.html#cut"><span class="std std-ref">cut</span></a> or by
extracting the <code class="docutils literal notranslate"><span class="pre">data</span></code> property from an <code class="docutils literal notranslate"><span class="pre">sqw</span></code> directly) certain operations
are no longer possible or act differently because the <code class="docutils literal notranslate"><span class="pre">dnd</span></code> no longer has the
underlying pixel data. This means that only operation which can act on the
intensity histogram are possible.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The technical differences between <code class="docutils literal notranslate"><span class="pre">dnd</span></code> and <code class="docutils literal notranslate"><span class="pre">sqw</span></code> objects is covered in
more detail in <a class="reference internal" href="../user_guide/Advanced_use.html#creating-an-object-from-scratch"><span class="std std-ref">Advanced use</span></a>.</p>
</div>
</section>
<section id="memory-requirements">
<h3>Memory requirements<a class="headerlink" href="#memory-requirements" title="Permalink to this heading"></a></h3>
<p>Equivalent <code class="docutils literal notranslate"><span class="pre">sqw</span></code> and <code class="docutils literal notranslate"><span class="pre">dnd</span></code> objects require vastly different amounts of
computer memory. The <code class="docutils literal notranslate"><span class="pre">dnd</span></code> object is usually relatively small (typically
0.1-10MB), whereas an <code class="docutils literal notranslate"><span class="pre">sqw</span></code> object can easily be multiple GB. This is because
of the returntion of each detector-energy pixel element that contributed to the
observed signal. In a normal Horace experiment this often equates to many
millions of detector elements, hence the large memory requirement to store all
this information.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code class="docutils literal notranslate"><span class="pre">.sqw</span></code> files that are created from experiments can easily exceed 1TB and
may take a long time to process!</p>
</div>
</section>
<section id="implications-for-simulations-and-fitting">
<h3>Implications for simulations and fitting<a class="headerlink" href="#implications-for-simulations-and-fitting" title="Permalink to this heading"></a></h3>
<p>The difference between <code class="docutils literal notranslate"><span class="pre">sqw</span></code> and <code class="docutils literal notranslate"><span class="pre">dnd</span></code> objects is clearly manifest, and
potentially most significant, when simulating and/or fitting a <span class="math notranslate nohighlight">\(S(\mathbf{Q}, \omega)\)</span> model to
the data.</p>
<p>Consider the case of a 2-dimensional slice created by:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">proj</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">line_proj</span><span class="p">([</span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="p">]);</span>
<span class="n">w</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cut</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">proj</span><span class="p">,</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="w"> </span><span class="mf">0.5</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">10</span><span class="w"> </span><span class="mi">20</span><span class="p">]);</span>
</pre></div>
</div>
<p>where the plot axes are <span class="math notranslate nohighlight">\((h,0,0)\)</span> and <span class="math notranslate nohighlight">\((0,k,0)\)</span>, and we integrate
energy between 10meV and 20meV and integrate (0,0,l) between -0.5 and 0.5.</p>
<p>Suppose this material is 3-dimensional, so that there are excitations that
disperse along all 3 of the <strong>Q</strong> directions. We simulate a model <span class="math notranslate nohighlight">\(S(\mathbf{Q}, \omega)\)</span> which
includes this 3-dimensional dispersion, but find that the simulations look
totally different if we simulate equivalent <code class="docutils literal notranslate"><span class="pre">dnd</span></code> and <code class="docutils literal notranslate"><span class="pre">sqw</span></code> data
objects. What is going on?</p>
<p>For the <code class="docutils literal notranslate"><span class="pre">sqw</span></code> object, the <span class="math notranslate nohighlight">\(S(\mathbf{Q}, \omega)\)</span> model is calculated at the <span class="math notranslate nohighlight">\((h,k,l,e)\)</span>
co-ordinates of every single contributing detector pixel (of which there are
potentially many millions), and then combined in the same way that the data are
to produce a 2-dimensional colour map. Because we integrated over quite a wide
range of <span class="math notranslate nohighlight">\((0,0,l)\)</span> and energy, detector elements with similar
<span class="math notranslate nohighlight">\((h,k)\)</span> co-ordinates of can have totally different <span class="math notranslate nohighlight">\((0,0,l)\)</span> and
energy co-ordinates, and hence totally different <span class="math notranslate nohighlight">\(S(\mathbf{Q}, \omega)\)</span>. When we sum these
elements together we get something that should (assuming the model is good) look
very similar to the data.</p>
<p>For the <code class="docutils literal notranslate"><span class="pre">dnd</span></code> object, we do not have the the <span class="math notranslate nohighlight">\((0,0,l)\)</span> and energy
co-ordinates of the contributing detector elements any more. So for each
<span class="math notranslate nohighlight">\((h,k)\)</span> bin we only have the average value of <span class="math notranslate nohighlight">\((0,0,l)\)</span> and energy -
in this case <code class="docutils literal notranslate"><span class="pre">l=0</span></code> and <code class="docutils literal notranslate"><span class="pre">e=15meV</span></code> respectively. The <span class="math notranslate nohighlight">\(S(\mathbf{Q}, \omega)\)</span> model is thus only
evaluated at these single points in <span class="math notranslate nohighlight">\((0,0,l)\)</span> and energy. As a result, the
full dispersion is not captured and the simulated intensity is likely to be
wrong.</p>
<p>A caveat to this is the case where the <span class="math notranslate nohighlight">\(S(\mathbf{Q}, \omega)\)</span> model does not give a 3-dimensional
dispersion, e.g. <span class="math notranslate nohighlight">\(S(\mathbf{Q}, \omega)\)</span> is independent of <span class="math notranslate nohighlight">\((0,0,l)\)</span>. In this case the
<code class="docutils literal notranslate"><span class="pre">dnd</span></code> and <code class="docutils literal notranslate"><span class="pre">sqw</span></code> object simulations will be the same.</p>
</section>
</section>
<section id="i-ve-got-a-problem-and-i-can-t-find-figure-out-how-to-solve-it-from-the-information-on-this-website">
<h2>I’ve got a problem and I can’t find figure out how to solve it from the information on this website!<a class="headerlink" href="#i-ve-got-a-problem-and-i-can-t-find-figure-out-how-to-solve-it-from-the-information-on-this-website" title="Permalink to this heading"></a></h2>
<p>First, try using the <strong>Search docs</strong> on the left-hand side of all the pages on
this website. In the case that you have found the function you need and it is
failing, make sure you are looking at the docs for the <a class="reference internal" href="../Previous_versions.html#previous-versions"><span class="std std-ref">correct version</span></a> of Horace.</p>
<p>If that fails, or the information on the site doesn’t answer your question,
email us at <a class="reference external" href="mailto:HoraceHelp&#37;&#52;&#48;stfc&#46;ac&#46;uk">Horace Help</a>. We will be happy to
help you.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Input_file_formats.html" class="btn btn-neutral float-left" title="Input file formats" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../Unsorted.html" class="btn btn-neutral float-right" title="Unsorted Manual Pages" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2006-2023, STFC RAL.
      <span class="lastupdated">Last updated on Dec 13, 2023, 5:12:32 PM.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
<br><br>
<a href="https://github.com/pace-neutrons/Horace/edit/master/documentation/user_docs/docs/manual/FAQ.rst">Click here to edit</a> or <a href="https://github.com/pace-neutrons/Horace/edit/master/documentation/user_docs/docs/new_page.rst">Click here to add new page</a> (requires <a href="https://github.com/login">GitHub account</a>).
<br>
For more info on editing <a href="../Contributing.html">click here</a>.


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>